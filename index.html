<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
    <script src="js/metrics.js" defer></script>
<title>Zetels - realtime ANP</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav>
        <ul>
            <div class="nav-center">
                <li><a class="active" href="index.html">Zetels</a></li>
                <li><a href="stemcijfers.html">Stemcijfers</a></li>
                <li><a href="anpupdates.html">ANP Updates</a></li>
                <li><a href="nosupdates.html">NOS Updates</a></li>
            </div>
            <li class="right-controls">
              <span id="soundWrap" class="sound-wrap">
                <span class="tooltip">
                  <button id="soundToggle" class="sound-button">üîá</button>
                  <span class="tooltiptext">Wordt ge√Ønformeerd als stemmen binnenkomen of zetels wijzigen</span>
                </span>
                <button id="soundPrompt" class="sound-prompt" style="display:none;">Geluid inschakelen</button>
              </span>
              <span id="completedBadge" class="info-badge" style="display:none;"></span>
              <select id="yearSelect" class="year-select" aria-label="Kies verkiezingsjaar"></select>
            </li>
        </ul>
</nav>
    <!-- NOS latest updates ticker -->
    <div id="nosTickerContainer" class="ticker-container" aria-label="Laatste NOS updates"></div>
    
    <div id="latestRestSeatImpactContainer"></div>
    <div id="impactShareBar" class="share-bar" aria-label="Deel restzetelstatus">
      <button id="impactShareX" class="share-btn" type="button" aria-label="Deel op Twitter">
        <svg class="icon" viewBox="0 0 16 16" aria-hidden="true"><path d="M3 2l10 12M13 2L3 14" stroke="#111" stroke-width="2" fill="none" stroke-linecap="round"/></svg>
        <span>Twitter</span>
      </button>
      <button id="impactShareWA" class="share-btn" type="button" aria-label="Deel via WhatsApp">
        <svg class="icon wa-icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M20.5 3.5c-2.2-2.2-5.1-3.4-8.2-3.4C5.7.1 1 4.8 1 10.7c0 1.9.5 3.7 1.3 5.3L1 23l7.1-1.9c1.5.8 3.2 1.2 4.9 1.2 5.9 0 10.6-4.7 10.6-10.6 0-3-1.2-6-3.4-8.2zM13 20.3c-1.5 0-3-.4-4.3-1.1l-.3-.2-4.2 1.1 1.1-4.1-.2-.3c-.7-1.3-1.1-2.7-1.1-4.2 0-4.8 3.9-8.7 8.7-8.7 2.3 0 4.5.9 6.1 2.5 1.6 1.6 2.5 3.8 2.5 6.1 0 4.8-3.9 8.7-8.7 8.7zm4.3-6.7c-.2-.1-1.1-.5-1.3-.6-.2-.1-.4-.1-.6.1l-.5.5c-.1.1-.3.1-.5.1-1-.5-1.9-1.2-2.7-2-.8-.8-1.5-1.7-2-2.7 0-.2 0-.4.1-.5l.5-.5c.2-.2.2-.4.1-.6-.1-.2-.5-1.1-.6-1.3-.1-.2-.3-.3-.6-.3h-.5c-.2 0-.5.1-.7.3-.8.8-1.2 1.9-1.1 3.1 0 1.3.8 2.6.9 2.8.2.3 1.8 2.9 4.5 4.1.6.3 1.2.5 1.8.6.2 0 .3 0 .5 0 .3 0 .6-.1.8-.3.1-.1.2-.2.3-.4.1-.2.1-.3.1-.4 0-.1 0-.3-.1-.4-.1-.2-.5-.3-.7-.4z" fill="currentColor"/>
        </svg>
        <span>WhatsApp</span>
      </button>
      <button id="impactShareWeb" class="share-btn" type="button" aria-label="Download afbeelding">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
          <rect x="3" y="5" width="18" height="14" rx="2" ry="2" stroke="#111" stroke-width="2" fill="none"/>
          <circle cx="9" cy="10" r="2" fill="#111"/>
          <path d="M7 17l4-4 3 3 3-3 3 4" fill="none" stroke="#111" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span>Deel</span>
      </button>
      <span id="impactProgressWrap" class="tooltip" style="display:none;">
        <button id="impactProgressBtn" class="share-btn" type="button" aria-label="Voortgang telling"><span id="impactProgressValue">‚Äì</span> stemmen geteld <svg class="progress-info-icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="9" fill="none" stroke="white" stroke-width="2" opacity="0.95"/><line x1="12" y1="10" x2="12" y2="16" stroke="white" stroke-width="2" stroke-linecap="round" opacity="0.95"/><circle cx="12" cy="7.5" r="1.5" fill="white" opacity="0.95"/></svg></button>
        <span class="tooltiptext" id="impactProgressTT">Laden...</span>
      </span>
    </div>
    <h1 class="title-enhanced">Zetelverdeling</h1>
    <div id="seatsBlock">
    <details class="explain-block">
      <summary><svg class="info-icon" width="16" height="16" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="10" fill="#e0f2fe" stroke="#0ea5e9" stroke-width="2"/><line x1="12" y1="8" x2="12" y2="8" stroke="#0369a1" stroke-width="2" stroke-linecap="round"/><line x1="12" y1="11" x2="12" y2="17" stroke="#0369a1" stroke-width="2" stroke-linecap="round"/></svg> Klik voor uitleg over berekening</summary>
      <div class="explain-body">
        <p>In Nederland worden in totaal 150 zetels verdeeld. Eerst krijgt elke partij de <em>volle zetels</em> die zij haalt met de kiesdeler. De zetels die daarna nog overblijven heten <em>restzetels</em> en die gaan naar partijen met het hoogste stemgemiddelde (D‚ÄôHondt). Voor de bekende ‚Äúnet wel / net niet‚Äù-situaties is uiteindelijk de allerlaatste restzetel bepalend.</p>
        <p><strong>Kiesdeler</strong> = (totaal aantal <em>geldige</em> uitgebrachte stemmen, incl. blanco) √∑ 150.</p>
        <ul>
          <li><strong>Volle zetels</strong>: het aantal keer dat een partij de kiesdeler haalt.</li>
          <li><strong>Restzetels</strong>: zetels die overblijven na de volle zetels; toegewezen op basis van het hoogste stemgemiddelde. Alleen de <em>laatste</em> restzetel beslist of een partij net een extra zetel krijgt of juist verliest.</li>
        </ul>
        <p>Blanco stemmen en stemmen op partijen die niet minimaal √©√©n keer de volle kiesdeler halen, stromen automatisch door naar de restzetelverdeling. Door het systeem van het hoogste stemgemiddelde (D‚ÄôHondt) komen grotere partijen relatief vaker in aanmerking voor een (extra) restzetel.</p>
        <p><strong>Hoe werkt het hoogste stemgemiddelde (D‚ÄôHondt) per restzetel?</strong></p>
        <ol> 
          <li>Bereken voor <em>iedere</em> partij het stemgemiddelde = (totaal geldige stemmen) √∑ (<em>reeds behaalde zetels</em> + 1). <span class="muted">Reeds behaalde zetels = volle zetels + eerder toegekende restzetels.</span></li>
          <li>De partij met het hoogste gemiddelde krijgt de <em>volgende</em> restzetel.</li>
          <li>Herhaal dit totdat alle restzetels verdeeld zijn.</li>
          <li>De <em>allerlaatste</em> restzetel bepaalt uiteindelijk wie net een extra zetel krijgt of net verliest. Immers net een extra zetel winnen betekent altijd de laatste restzetel winnen, terwijl net een zetel verliezen altijd betekent dat de laatste restzetel net niet behaald wordt.</li>
        </ol>
        <p><u>Stemmen over</u> geeft aan hoeveel extra stemmen een partij heeft boven het minimum dat nodig is om haar <em>huidige</em> zetelaantal te behouden en eventueel net aan de laatste restzetel te winnen.<br>
        <u>Stemmen tekort</u> geeft aan hoeveel stemmen de partij nog nodig heeft voor precies <em>√©√©n</em> extra restzetel, ten koste van een andere partij.</p>
        <p class="section-gap"></p>
        <p><strong>Bronnen en actualiteit</strong>: zodra de <em>Kiesraad</em>-uitslag beschikbaar is, wordt daarmee gerekend. Daarvoor wordt gerekend met <em>ANP</em> of <em>NOS</em> cijfers op basis van de bron met de laatste update. De kiesdeler en zetelverdeling worden automatisch bijgewerkt na elke binnengekomen stem.</p>
      </div>
    </details>
    <!-- legacy inline NOS update removed; ticker shows latest updates -->
    <div id="seatsSummaryContainer"></div>
    </div>

    <div class="flex-container">
        <div class="flex-item">
            <div class="seatstrip-tooltip">
              <h2 class="title-enhanced">Stemgemiddelde per restzetel</h2>
              <div id="seatStripTooltip" class="seatstrip-panel"></div>
            </div>
            <div id="voteAverageContainer"></div>
        </div>
    </div>
    <!-- Include unified scripts -->
   <script src="js/config.js" defer></script>
   <script src="js/year-nav.js" defer></script>
   <script src="js/sound.js" defer></script>
   <script src="js/data.js" defer></script>
   <script src="js/ticker.js" defer></script>
   <script src="js/ui.js" defer></script>
   <script src="js/auto_refresh.js" defer></script>
   <script src="js/app.js" defer></script>

   <script>
        window.addEventListener('DOMContentLoaded', function(){
          try { if (window.UI && UI.initBlockWidthSync) { UI.initBlockWidthSync('seatsBlock','seatsSummaryContainer'); } } catch(e){}
          function loadYearData(year) { RestzetelsApp.loadZetels(year); }
          if (window.YearNav && window.Sound && window.AutoRefresh) {
            YearNav.init({ load: loadYearData });
            Sound.init();
            AutoRefresh.init({ load: loadYearData });
          } else {
            // In case defer/load order varies, retry shortly
            const t = setInterval(function(){
              if (window.YearNav && window.Sound && window.AutoRefresh) {
                clearInterval(t);
                YearNav.init({ load: loadYearData });
                Sound.init();
                AutoRefresh.init({ load: loadYearData });
              }
            }, 10);
          }
        });
    </script>



</body>
</html>
